




  
    
    
    

<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Tutorials - Controlling the CoM - mc_rtc</title>

    <link rel="apple-touch-icon" sizes="180x180" href="/mc_rtc/assets/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/mc_rtc/assets/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/mc_rtc/assets/favicons/favicon-16x16.png">
    <link rel="manifest" href="/mc_rtc/assets/favicons/site.webmanifest">
    <link rel="mask-icon" href="/mc_rtc/assets/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/8.0.0/build.css" integrity="sha256-iPUhChwurLRCrDCM1+2a2LDe9pfW6Je29o/oA5VPr28=" crossorigin="anonymous" />

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>

    

    <link href="/mc_rtc/css/mc_rtc.css" rel="stylesheet">
  </head>

  <body>
    <header class="navbar navbar-expand-lg navbar-light bg-light sticky-top" role="navigation">
      <a class="navbar-brand" href="/mc_rtc/index.html"><img src="/mc_rtc/assets/logo.png" alt="logo" width="30" height="30"/> mc_rtc</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarText">
        <div class="navbar-nav mr-auto">
          
          
          
          <a class="nav-item nav-link " href="/mc_rtc/interfaces.html">Interfaces</a>
          
          
          
          
          <a class="nav-item nav-link " href="/mc_rtc/robots.html">Robots</a>
          
          
          
          
          <a class="nav-item nav-link active" href="/mc_rtc/tutorials.html">Tutorials</a>
          
          
          
          
          <a class="nav-item nav-link " href="/mc_rtc/doxygen.html">API documentation</a>
          
          
          
          
          <a class="nav-item nav-link " href="/mc_rtc/json.html">JSON/YAML documentation</a>
          
          
        </div>
        <a href="https://github.com/jrl-umi3218/mc_rtc" target="blank_"><svg height="25" width="25" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a>
      </div>
    </header>

    <div class="container-fluid">
      <div class="row">
      <div class="col">
        <ul>
          
          <li>Introduction</li>
          <ul>
            
              
              <li><a href="/mc_rtc/tutorials/introduction/installation-guide.html">Installation guide</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/introduction/configuration.html">Configuring mc_rtc</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/introduction/running-a-controller.html">Running a controller</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/introduction/first-controller.html">Your first controller with mc_rtc</a></li>
              
            
              
              <li><strong>Controlling the CoM</strong></li>
                
              
            
              
              <li><a href="/mc_rtc/tutorials/introduction/ef-controller.html">Controlling an end-effector (and loading)</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/introduction/multi-robot-controller.html">Multi-robot controller</a></li>
              
            
          </ul>
          
          <li>Framework usage</li>
          <ul>
            
              
              <li><a href="/mc_rtc/tutorials/usage/mc_rtc_configuration.html"><code>mc_rtc::Configuration</code> general purpose configuration</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/usage/logging.html">Logging data</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/usage/console-logging.html">Printing information to the screen</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/usage/gui.html">Graphical User Interface (GUI)</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/usage/live-plotting.html">Display plots live from the controller</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/usage/ros.html">ROS integration</a></li>
              
            
          </ul>
          
          <li>Framework tools</li>
          <ul>
            
              
              <li><a href="/mc_rtc/tutorials/tools/mc_log_utils.html">Log manipulation</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/tools/mc_log_ui.html">Log plotting</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/tools/mc_log_visualization.html">Replay visualization</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/tools/mc_surfaces_visualization.html">Visualizing surfaces</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/tools/mc_convex_visualization.html">Visualizing convexes</a></li>
              
            
          </ul>
          
          <li>Control recipes</li>
          <ul>
            
              
              <li><a href="/mc_rtc/tutorials/recipes/fsm.html">Using the FSM facilities</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/fsm-example.html">FSM controller in practice</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/derived-fsm.html">Deriving the FSM controller</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/observers.html">Using the observers pipeline</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/speed-constraint.html">Constraint the speed of a body</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/moving-a-contact.html">Moving a contact</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/contact-dof.html">Change the DoF constraints on a contact</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/joint-select.html">Select specific joints for a task</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/dim-weight.html">Affect different weight to different axis in the task space</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/joint-stiffness.html">Joints Stiffness</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/recipes/com-constraint.html">Constraining the accessible region of the CoM</a></li>
              
            
          </ul>
          
          <li>Advanced topics</li>
          <ul>
            
              
              <li><a href="/mc_rtc/tutorials/advanced/new-interface.html">Implement a new mc_rtc interface</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/advanced/new-environment.html">Environment creation for mc_rtc</a></li>
              
            
              
              <li><a href="/mc_rtc/tutorials/advanced/new-robot.html">Integrate a new robot in mc_rtc</a></li>
              
            
          </ul>
          
        </ul>
      </div>
      <div class="col-9">
        <h1>Controlling the CoM</h1>

        <p>The objective of this tutorial is to control the robot's center of mass (CoM). As in the previous tutorial, we will write a function that moves the CoM down 20 centimeters and then moves it back to its original position.</p>

<h3>Contacts</h3>

<p>Before we start moving the CoM we need to consider contacts. In fact, in our previous controller we decided to keep an empty contact set and everything worked well. However, if we were trying to control the CoM now, the robot would simply sink into the ground or float in the air to follow our command. The reason is simply that without contacts, this is a perfect solution to moving the CoM while keeping a minimal posture error.</p>

<p>Therefore, we will add contacts between the robot's feet and the ground:</p>

<ul class="nav nav-tabs" id="add_contactTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="add_contactC++cppTab" data-toggle="tab" href="#add_contactC++cppTabContent" role="tab" aria-controls="add_contactC++cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="add_contactPythonpythonTab" data-toggle="tab" href="#add_contactPythonpythonTabContent" role="tab" aria-controls="add_contactPythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="add_contactTabContent">
  
    
    
    <div class="tab-pane show active" id="add_contactC++cppTabContent" role="tabpanel" arial-labelledby="add_contactC++cppTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="c1">// In the constructor</span>
<span class="n">solver</span><span class="p">().</span><span class="n">setContacts</span><span class="p">({</span>
  <span class="p">{</span><span class="n">robots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"LeftFoot"</span><span class="p">,</span> <span class="s">"AllGround"</span><span class="p">},</span>
  <span class="p">{</span><span class="n">robots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"RightFoot"</span><span class="p">,</span> <span class="s">"AllGround"</span><span class="p">}</span>
<span class="p">});</span></code></pre></figure>

  </div>
</div>


    </div>
  
    
    
    <div class="tab-pane" id="add_contactPythonpythonTabContent" role="tabpanel" arial-labelledby="add_contactPythonpythonTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># In the constructor
</span><span class="bp">self</span><span class="o">.</span><span class="n">qpsolver</span><span class="o">.</span><span class="n">setContacts</span><span class="p">([</span>
  <span class="n">mc_rbdyn</span><span class="o">.</span><span class="n">Contact</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"LeftFoot"</span><span class="p">,</span> <span class="s">"AllGround"</span><span class="p">),</span>
  <span class="n">mc_rbdyn</span><span class="o">.</span><span class="n">Contact</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"RightFoot"</span><span class="p">,</span> <span class="s">"AllGround"</span><span class="p">)</span>
<span class="p">])</span></code></pre></figure>

  </div>
</div>


    </div>
  
</div>


<p><em>Note: see the <a href="/mc_rtc/tutorials/tools/mc_surfaces_visualization.html">tutorial on surfaces visualization</a> to check out how you can "discover" existing surfaces in a robot.</em></p>

<h3>Dynamics constraint</h3>

<p>Until now we have run the controller in kinematics mode. We can switch to dynamics mode, this will enable us to:</p>

<ul>
  <li>Compute external forces and associated torques;</li>
  <li>These forces remain in the contact friction cone;</li>
  <li>The torques remain within the robot's torque limits;</li>
</ul>

<p>To switch, simply change <code>kinematicsConstraint</code> into <code>dynamicsConstraint</code> in your code. All constraints enabled by <code>kinematicsConstraints</code> are also enabled by <code>dynamicsConstraint</code>.</p>

<h3>Create the CoM task and add it to the problem</h3>

<p>We need to take care of a few things:</p>

<ol>
  <li>Create the CoM task;</li>
  <li>Add it to the optimization problem;</li>
  <li>Make sure its objective is correctly set;</li>
</ol>

<ul class="nav nav-tabs" id="create_com_taskTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="create_com_taskC++cppTab" data-toggle="tab" href="#create_com_taskC++cppTabContent" role="tab" aria-controls="create_com_taskC++cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="create_com_taskPythonpythonTab" data-toggle="tab" href="#create_com_taskPythonpythonTabContent" role="tab" aria-controls="create_com_taskPythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="create_com_taskTabContent">
  
    
    
    <div class="tab-pane show active" id="create_com_taskC++cppTabContent" role="tabpanel" arial-labelledby="create_com_taskC++cppTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="c1">// Include the CoM task header (header)</span>
<span class="cp">#include &lt;mc_tasks/CoMTask.h&gt;
</span><span class="c1">// In the class private members (header)</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">mc_tasks</span><span class="o">::</span><span class="n">CoMTask</span><span class="o">&gt;</span> <span class="n">comTask</span><span class="p">;</span>
<span class="c1">// In the constructor, create the task and add it to the problem</span>
<span class="n">comTask</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mc_tasks</span><span class="o">::</span><span class="n">CoMTask</span><span class="o">&gt;</span><span class="p">(</span><span class="n">robots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">);</span>
<span class="n">solver</span><span class="p">().</span><span class="n">addTask</span><span class="p">(</span><span class="n">comTask</span><span class="p">);</span>
<span class="c1">// Reduce the posture task stiffness</span>
<span class="n">postureTask</span><span class="o">-&gt;</span><span class="n">stiffness</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="c1">// In the reset function, reset the task to the current CoM</span>
<span class="n">comTask</span><span class="o">-&gt;</span><span class="n">reset</span><span class="p">();</span></code></pre></figure>

  </div>
</div>


    </div>
  
    
    
    <div class="tab-pane" id="create_com_taskPythonpythonTabContent" role="tabpanel" arial-labelledby="create_com_taskPythonpythonTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Import the mc_tasks module
</span><span class="kn">import</span> <span class="nn">mc_tasks</span>
<span class="c1"># In the constructor, create the task and add it to the problem
</span><span class="bp">self</span><span class="o">.</span><span class="n">comTask</span> <span class="o">=</span> <span class="n">mc_tasks</span><span class="o">.</span><span class="n">CoMTask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">robots</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">qpsolver</span><span class="o">.</span><span class="n">addTask</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comTask</span><span class="p">)</span>
<span class="c1"># Reduce the posture task stiffness
</span><span class="bp">self</span><span class="o">.</span><span class="n">postureTask</span><span class="o">.</span><span class="n">stiffness</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># In the reset callback, reset the task to the current CoM
</span><span class="bp">self</span><span class="o">.</span><span class="n">comTask</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></code></pre></figure>

  </div>
</div>


    </div>
  
</div>


<p>In that particular example, we can say a few things about the task creation:</p>

<ol>
  <li>It depends on <code>robots()</code>;</li>
  <li>It will be applied to the robot with index 0, this is always the main robot loaded by mc_rtc;</li>
  <li>It is attracted to the objective with a stiffness of <code>10.0</code>; this parameter governs the strength of the "spring" that pulls the robot towards the objective;</li>
  <li>It is associated a weight of <code>1000</code>; this weight is the priority of the task in the optimization problem. In our case, the default posture weight is <code>5.0</code>, thus the CoM task will have high priority. Please note that task errors are not normalized, and thus weights have to be tuned accordingly;</li>
  <li>The posture task stiffness is decreased to make sure it doens't interfere with the CoM task;</li>
</ol>

<h3>Moving the CoM up and down</h3>

<p>We will implement a method similar to the previous tutorial, using a <code>switch_com_target()</code> function. We will assume we have added a <code>comDown</code> boolean and a <code>comZero</code> which is an <code>Eigen::Vector3d</code> representing the initial CoM position.</p>

<ul class="nav nav-tabs" id="switch_comTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="switch_comC++cppTab" data-toggle="tab" href="#switch_comC++cppTabContent" role="tab" aria-controls="switch_comC++cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="switch_comPythonpythonTab" data-toggle="tab" href="#switch_comPythonpythonTabContent" role="tab" aria-controls="switch_comPythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="switch_comTabContent">
  
    
    
    <div class="tab-pane show active" id="switch_comC++cppTabContent" role="tabpanel" arial-labelledby="switch_comC++cppTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">MyFirstController</span><span class="o">::</span><span class="n">switch_com_target</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// comZero is obtained by doing:</span>
  <span class="c1">// comZero = comTask-&gt;com();</span>
  <span class="c1">// in the reset function</span>
  <span class="k">if</span><span class="p">(</span><span class="n">comDown</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">com</span><span class="o">-&gt;</span><span class="n">com</span><span class="p">(</span><span class="n">comZero</span> <span class="o">-</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">});</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">com</span><span class="o">-&gt;</span><span class="n">com</span><span class="p">(</span><span class="n">comZero</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">comDown</span> <span class="o">=</span> <span class="o">!</span><span class="n">comDown</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

  </div>
</div>


    </div>
  
    
    
    <div class="tab-pane" id="switch_comPythonpythonTabContent" role="tabpanel" arial-labelledby="switch_comPythonpythonTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">switch_com_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># self.comZero is obtained by doing:
</span>    <span class="c1"># self.comZero = self.comTask.com()
</span>    <span class="c1"># in the reset function after doing the CoM task reset
</span>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comDown</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comTask</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comZero</span> <span class="o">-</span> <span class="n">eigen</span><span class="o">.</span><span class="n">Vector3d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comTask</span><span class="o">.</span><span class="n">com</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comZero</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">comDown</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">comDown</span></code></pre></figure>

  </div>
</div>


    </div>
  
</div>


<p>Finally, we will monitor the CoM task error to trigger target changes:</p>

<ul class="nav nav-tabs" id="runTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="runC++cppTab" data-toggle="tab" href="#runC++cppTabContent" role="tab" aria-controls="runC++cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="runPythonpythonTab" data-toggle="tab" href="#runPythonpythonTabContent" role="tab" aria-controls="runPythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="runTabContent">
  
    
    
    <div class="tab-pane show active" id="runC++cppTabContent" role="tabpanel" arial-labelledby="runC++cppTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">bool</span> <span class="n">MyFirstController</span><span class="o">::</span><span class="n">run</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">comTask</span><span class="o">-&gt;</span><span class="n">eval</span><span class="p">().</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">switch_com_target</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">mc_control</span><span class="o">::</span><span class="n">MCController</span><span class="o">::</span><span class="n">run</span><span class="p">();</span>
<span class="p">}</span></code></pre></figure>

  </div>
</div>


    </div>
  
    
    
    <div class="tab-pane" id="runPythonpythonTabContent" role="tabpanel" arial-labelledby="runPythonpythonTab">
      
<div class="card bg-light card-source">
  <div class="card-body">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comTask</span><span class="o">.</span><span class="nb">eval</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_com_target</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">True</span></code></pre></figure>

  </div>
</div>


    </div>
  
</div>


<p>Et voil&agrave;! You can run this controller and see that the robot is moving down and up. In the next tutorial we will see how to move an end-effector and to load the task configuration from the disk.</p>

<p>The full sources for this controller are available <a href="sources/com-controller.html">here</a>.</p>


        <hr/>
        
        <div class="text-right">
        <a href="/mc_rtc/tutorials/introduction/ef-controller.html">Next tutorial: Controlling an end-effector (and loading)</a>
        </div>
        
      </div>
      </div>
    </div>

    <div class="container-fluid">
      <footer>
        <hr>
        <div class="row">
          <div class="col-8 offset-lg-2 col-lg-6">
            Copyright &copy; CNRS-AIST JRL, CNRS LIRMM 2015-2019
          </div>
          <div class="col-4 col-lg-2 text-right">
            <a href="/mc_rtc/credits.html">Credits</a>
          </div>
        </div>
      </footer>
    </div>
  </body>

</html>
