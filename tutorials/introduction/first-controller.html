




  
    
    
    

<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">

<link rel="apple-touch-icon" sizes="180x180" href="/mc_rtc/assets/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/mc_rtc/assets/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/mc_rtc/assets/favicons/favicon-16x16.png">
<link rel="manifest" href="/mc_rtc/assets/favicons/site.webmanifest">
<link rel="mask-icon" href="/mc_rtc/assets/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>





<link href="/mc_rtc/css/mc_rtc.css" rel="stylesheet">

    <title>Tutorials - Your first controller with mc_rtc - mc_rtc</title>
  </head>

  <body>
    <header class="navbar navbar-expand-lg navbar-light bg-light sticky-top" role="navigation">
  <a class="navbar-brand" href="/mc_rtc/index.html"><img src="/mc_rtc/assets/logo.png" alt="logo" width="30" height="30"/> mc_rtc</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarText">
    <div class="navbar-nav mr-auto">
      
        
        
        <a class="nav-item nav-link " href="/mc_rtc/interfaces.html">Interfaces</a>
      
        
        
        <a class="nav-item nav-link " href="/mc_rtc/robots.html">Robots</a>
      
        
        
        <a class="nav-item nav-link active" href="/mc_rtc/tutorials.html">Tutorials</a>
      
        
        
        <a class="nav-item nav-link " href="/mc_rtc/doxygen.html">API documentation</a>
      
        
        
        <a class="nav-item nav-link " href="/mc_rtc/json.html">JSON/YAML documentation</a>
      
      <a class="nav-item nav-link" href="https://mc-rtc-demo.netlify.app/" target="blank_">Online demonstration</a>
    </div>
    
      
      
      
      EN
      
      
        &nbsp;|&nbsp;
      
    
      
      
      
        <a href="/mc_rtc/jp/tutorials/introduction/first-controller.html">
      
      JP
      
        </a>
      
      
        &nbsp;&nbsp;&nbsp;
      
    
    <a href="https://github.com/jrl-umi3218/mc_rtc" target="blank_"><svg height="25" width="25" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a>
  </div>
</header>


    <div class="container-fluid">
      <div class="row">
      <div class="col col-lg-3">
        <div class="sticky-top sticky-toc">
          <div class="accordion" id="accordionTutorials">
            <div class="card">
              <div class="card-header" id="headingOtherTutorials">
                <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseOtherTutorials" aria-expanded="true" aria-controls="collapseOtherTutorials">
                  Other tutorials
                </button>
              </div>
              <div id="collapseOtherTutorials" class="collapse" arial-labelledby="headingOtherTutorials" data-parent="#accordionTutorials">
                <div class="card-body">
                  <ul>
                    
                    <li>Introduction</li>
                    <ul>
                      
                        
                        <li><a href="/mc_rtc/tutorials/introduction/installation-guide.html">Installation guide</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/introduction/configuration.html">Configuring mc_rtc and its components</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/introduction/running-a-controller.html">Running a controller</a></li>
                        
                      
                        
                        <li><strong>Your first controller with mc_rtc</strong></li>
                          
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/introduction/com-controller.html">Controlling the CoM</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/introduction/ef-controller.html">Controlling an end-effector (and loading)</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/introduction/multi-robot-controller.html">Multi-robot controller</a></li>
                        
                      
                    </ul>
                    
                    <li>Framework usage</li>
                    <ul>
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/mc_rtc_configuration.html"><code>mc_rtc::Configuration</code> general purpose configuration</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/logging.html">Logging data</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/console-logging.html">Printing information to the screen</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/gui.html">Graphical User Interface (GUI)</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/live-plotting.html">Display plots live from the controller</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/ros.html">ROS integration</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/usage/global-plugins.html">Using global plugins</a></li>
                        
                      
                    </ul>
                    
                    <li>Framework tools</li>
                    <ul>
                      
                        
                        <li><a href="/mc_rtc/tutorials/tools/mc_log_utils.html">Log manipulation</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/tools/mc_log_ui.html">Log plotting</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/tools/mc_log_visualization.html">Replay visualization</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/tools/mc_surfaces_visualization.html">Visualizing surfaces</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/tools/mc_convex_visualization.html">Visualizing convexes</a></li>
                        
                      
                    </ul>
                    
                    <li>Control recipes</li>
                    <ul>
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/fsm.html">Using the FSM facilities</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/fsm-main-states.html">Main FSM states</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/fsm-example.html">FSM controller in practice</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/derived-fsm.html">Deriving the FSM controller</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/datastore.html">DataStore: Sharing Objects</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/observers.html">State Observation Pipelines</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/lipm-stabilizer.html">Using the LIPM Stabilizer</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/speed-constraint.html">Constraint the speed of a body</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/moving-a-contact.html">Moving a contact</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/contact-dof.html">Change the DoF constraints on a contact</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/joint-select.html">Select specific joints for a task</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/dim-weight.html">Affect different weight to different axis in the task space</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/joint-stiffness.html">Joints Stiffness</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/recipes/com-constraint.html">Constraining the accessible region of the CoM</a></li>
                        
                      
                    </ul>
                    
                    <li>Samples</li>
                    <ul>
                      
                        
                        <li><a href="/mc_rtc/tutorials/samples/list-of-samples.html">Available sample controllers</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/samples/sample-admittance.html">Admittance sample controller</a></li>
                        
                      
                    </ul>
                    
                    <li>Advanced topics</li>
                    <ul>
                      
                        
                        <li><a href="/mc_rtc/tutorials/advanced/new-plugin.html">Implement a new plugin for mc_rtc</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/advanced/new-interface.html">Implement a new mc_rtc interface</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/advanced/new-environment.html">Environment creation for mc_rtc</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/advanced/new-robot.html">Integrate a new robot in mc_rtc</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/advanced/support-mc-rtc-build-static.html">Supporting MC_RTC_BUILD_STATIC in your code</a></li>
                        
                      
                        
                        <li><a href="/mc_rtc/tutorials/advanced/debug-lssol-output-6.html">Debugging LSSOL output 6</a></li>
                        
                      
                    </ul>
                    
                  </ul>
                </div>
              </div>
              
                <ul id="toc" class="section-nav">
<li class="toc-entry toc-h3"><a href="#creating-and-running-the-controller-skeleton">Creating and running the controller skeleton</a></li>
<li class="toc-entry toc-h3"><a href="#understanding-the-skeleton-code-step-by-step">Understanding the skeleton code step-by-step</a></li>
<li class="toc-entry toc-h3"><a href="#shaking-the-head-left-and-right">Shaking the head left and right</a>
<ul>
<li class="toc-entry toc-h4"><a href="#find-out-available-joints-in-a-robot">Find out available joints in a robot</a></li>
</ul>
</li>
</ul>
              
            </div>
          </div>
        </div>
      </div>
      <div class="col-9" id="tutorial-content">
        
        <h1>Your first controller with mc_rtc</h1>
        

        <p>The goal of this tutorial is to show you how to create a new controller for mc_rtc. We will use the JVRC1 robot in our example and we will simply try to shake the head left and right</p>

<h3 id="creating-and-running-the-controller-skeleton">Creating and running the controller skeleton</h3>


<p><em>Note:</em> in mc_rtc, every controller derives from the <code>MCController</code> class. To write a simple controller you can also derive from it and write the required functionnality. This is what we will do in these tutorials. However, for more complex controllers we advise you to use the <a href="/mc_rtc/tutorials/recipes/fsm.html">FSM facilities</a></p>

<div class="no_toc_section">

<ul class="nav nav-tabs" id="make_new_controllerTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="make-new-controllerc-rawTab" data-toggle="tab" href="#make-new-controllerc-rawTabContent" role="tab" aria-controls="make-new-controllerc-rawTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="make-new-controllerpythonrawTab" data-toggle="tab" href="#make-new-controllerpythonrawTabContent" role="tab" aria-controls="make-new-controllerpythonrawTabContent" aria-selected="false">Python</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="make-new-controllergithubrawTab" data-toggle="tab" href="#make-new-controllergithubrawTabContent" role="tab" aria-controls="make-new-controllergithubrawTabContent" aria-selected="false">GitHub</a>
    </li>
  
</ul>
<div class="tab-content" id="make_new_controllerTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="make-new-controllerc-rawTabContent" role="tabpanel" arial-labelledby="make-new-controllerc-rawTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <p>We will use <code>mc_rtc_new_controller</code> provided by mc_rtc to setup a new controller project:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>mc_rtc_new_controller <span class="nt">--help</span>
usage: mc_rtc_new_controller <span class="o">[</span><span class="nt">-h</span><span class="o">]</span>
                             <span class="o">[</span>project directory] <span class="o">[</span>controller class name]
                             <span class="o">[[</span>controller name]]

Create a new mc_rtc Controller project

positional arguments:
  <span class="o">[</span>project directory]   Path of the project
  <span class="o">[</span>controller class name]
                        Name of the controller class
  <span class="o">[</span>controller name]     Name of the controller, defaults to controller class
                        name

optional arguments:
  <span class="nt">-h</span>, <span class="nt">--help</span>            show this <span class="nb">help </span>message and <span class="nb">exit</span></code></pre></figure>

<p><em>Note: this tool requires Git for Python which is available as python-git in Debian-like systems and GitPython in pip</em></p>

<p>In this tutorial we will create a tutorial controller named <code>MyFirstController</code>, so we can use the following command:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>mc_rtc_new_controller my_first_controller MyFirstController</code></pre></figure>

<p>Going into the newly created <code>my_first_controller</code> folder we can see some files have been automatically generated:</p>

<dl class="row">
  <dt class="col-3">CMakeLists.txt</dt>
  <dd class="col-9">A minimal CMake file to build your controller</dd>

  <dt class="col-3">etc/MyFirstController.yaml</dt>
  <dd class="col-9">Your controller configuration file see this <a href="/mc_rtc/tutorials/usage/mc_rtc_configuration.html">tutorial</a> for more details</dd>

  <dt class="col-3">src/CMakeLists.txt</dt>
  <dd class="col-9">Describe the source files required to build your controller</dd>

  <dt class="col-3">src/api.h</dt>
  <dd class="col-9">Declaration to make sure your controller will be loadable on all platforms</dd>

  <dt class="col-3">src/MyFirstController.h</dt>
  <dd class="col-9">Declare your controller class. It must inherits from mc_control::Controller and override at least the run function and the reset function</dd>

  <dt class="col-3">src/MyFirstController.cpp</dt>
  <dd class="col-9">Implement your controller. We will go over this in more details in the next sections</dd>
</dl>

<h4>Building the controller</h4>

<p>This is done using CMake and your usual tool to run CMake, build the code and install it. Typically, on Linux/MacOS:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> build
<span class="nv">$ </span><span class="nb">cd </span>build
<span class="c"># This build type provides good performance with debuggable code</span>
<span class="nv">$ </span>cmake ../ <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>RelWithDebInfo
<span class="nv">$ </span>make
<span class="nv">$ </span><span class="nb">sudo </span>make <span class="nb">install</span></code></pre></figure>

<p><em>Note: <code>sudo</code> is only required if mc_rtc is installed in a privileged directory</em></p>

<h4>Running the controller</h4>

<p>Modify your mc_rtc configuration file so that we use the JVRC1 robot and our newly installed controller:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"MainRobot"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JVRC1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Enabled"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"MyFirstController"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Then run your controller as explained in the previous section. Congratulations, you just built and and ran your first controller!</p>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="make-new-controllerpythonrawTabContent" role="tabpanel" arial-labelledby="make-new-controllerpythonrawTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <p>We will start by creating a new Python package:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> my_first_controller
<span class="nv">$ </span><span class="nb">touch </span>my_first_controller/__init__.py</code></pre></figure>

<p><em>Note: this assumes you are using a posix shell</em></p>

<p>Then we will create a file <code>my_first_controller.py</code> in the <code>my_first_controller</code> folder:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="kn">import</span> <span class="nn">mc_control</span>
<span class="kn">import</span> <span class="nn">mc_rbdyn</span>
<span class="kn">import</span> <span class="nn">mc_rtc</span>

<span class="k">class</span> <span class="nc">MyFirstController</span><span class="p">(</span><span class="n">mc_control</span><span class="p">.</span><span class="n">MCPythonController</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rm</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">qpsolver</span><span class="p">.</span><span class="n">addConstraintSet</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">kinematicsConstraint</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">qpsolver</span><span class="p">.</span><span class="n">addConstraintSet</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">contactConstraint</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">qpsolver</span><span class="p">.</span><span class="n">addTask</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">postureTask</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">def</span> <span class="nf">reset_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">mc_rbdyn</span><span class="p">.</span><span class="n">get_robot_module</span><span class="p">(</span><span class="s">"env"</span><span class="p">,</span> <span class="n">mc_rtc</span><span class="p">.</span><span class="n">MC_ENV_DESCRIPTION_PATH</span><span class="p">,</span> <span class="s">"ground"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">MyFirstController</span><span class="p">([</span><span class="n">robot</span><span class="p">,</span><span class="n">env</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>We also need to edit <code>__init__.py</code> so that the controller is available in the module:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">.my_first_controller</span> <span class="kn">import</span> <span class="n">MyFirstController</span></code></pre></figure>

<h4>Running the controller</h4>

<p>Modify your mc_rtc configuration file so that we use the JVRC1 robot and our new controller:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"MainRobot"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JVRC1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Enabled"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Python#my_first_controller.MyFirstController"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><em>Note: if you have enforced Python 2 or Python 3 or if you have installed both then you should explicitly choose <code>Python2</code> or <code>Python3</code>.</em></p>

<p>For this to work, we need to make sure the <code>my_first_controller</code> folder is on the Python path. In fact, given this configuration, mc_rtc will create your controller this way:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">my_first_controller</span> <span class="kn">import</span> <span class="n">MyFirstController</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">MyFirstController</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="k">return</span> <span class="n">controller</span></code></pre></figure>

<p>Typically, if you run <code>mc_rtc_ticker</code> and the <code>my_first_controller</code> folder is in <code>$HOME/my_python_controllers</code>, then you should run as follows:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ PYTHONPATH</span><span class="o">=</span><span class="nv">$HOME</span>/my_python_controllers:<span class="nv">$PYTHONPATH</span> rosrun mc_rtc_ticker mc_rtc_ticker</code></pre></figure>

<h4>Key difference with C++</h4>

<p>A key difference between the C++ controller and the Python controller is that the C++ controller let you bypass the call to <code>mc_control::MCController::run()</code> and <code>mc_control::MCController::reset()</code> functions if you like. Whereas in Python, <code>run_callback(self)</code> and <code>reset_callback(self, data)</code> will always be called <strong>after</strong> its C++ counterpart.</p>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="make-new-controllergithubrawTabContent" role="tabpanel" arial-labelledby="make-new-controllergithubrawTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <p>Use the <a href="https://github.com/mc-rtc/new-controller">mc-rtc/new-controller</a> template project. This is equivalent to using the <code>mc_rtc_new_controller</code> tool with extra goodies.</p>

  
  </div>
</div>

    </div>
  
</div>


</div>

<h3 id="understanding-the-skeleton-code-step-by-step">Understanding the skeleton code step-by-step</h3>


<p>Let's first have a look at the constructor:</p>

<ul class="nav nav-tabs" id="constructorTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="constructorc-cppTab" data-toggle="tab" href="#constructorc-cppTabContent" role="tab" aria-controls="constructorc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="constructorpythonpythonTab" data-toggle="tab" href="#constructorpythonpythonTabContent" role="tab" aria-controls="constructorpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="constructorTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="constructorc-cppTabContent" role="tabpanel" arial-labelledby="constructorc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">solver</span><span class="p">().</span><span class="n">addConstraintSet</span><span class="p">(</span><span class="n">contactConstraint</span><span class="p">);</span>
<span class="n">solver</span><span class="p">().</span><span class="n">addConstraintSet</span><span class="p">(</span><span class="n">kinematicsConstraint</span><span class="p">);</span>
<span class="n">solver</span><span class="p">().</span><span class="n">addTask</span><span class="p">(</span><span class="n">postureTask</span><span class="p">);</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="constructorpythonpythonTabContent" role="tabpanel" arial-labelledby="constructorpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="bp">self</span><span class="p">.</span><span class="n">qpsolver</span><span class="p">.</span><span class="n">addConstraintSet</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">kinematicsConstraint</span><span class="p">)</span>
<span class="bp">self</span><span class="p">.</span><span class="n">qpsolver</span><span class="p">.</span><span class="n">addConstraintSet</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">contactConstraint</span><span class="p">)</span>
<span class="bp">self</span><span class="p">.</span><span class="n">qpsolver</span><span class="p">.</span><span class="n">addTask</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">postureTask</span><span class="p">)</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p>They are very similar. We use existing objects in the base class to setup a basic controller:</p>

<ol>
  <li>We add a contact constraint. This is ensuring that contacts surfaces don't move once they are set;</li>
  <li>We add a kinematics constraint. This is ensuring the robot is subject to joint position and velocity limits;</li>
  <li>We add a posture task to control the robot posture;</li>
  <li>We set the contacts. For now we set an empty set of contacts as the control does not include dynamics;</li>
</ol>

<p>Now let's look at the <code>reset</code> function. This function is called when the controller is started (either when the interface starts or when the controllers are switched online).</p>

<ul class="nav nav-tabs" id="resetTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="resetc-cppTab" data-toggle="tab" href="#resetc-cppTabContent" role="tab" aria-controls="resetc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="resetpythonpythonTab" data-toggle="tab" href="#resetpythonpythonTabContent" role="tab" aria-controls="resetpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="resetTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="resetc-cppTabContent" role="tabpanel" arial-labelledby="resetc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">MyFirstController</span><span class="o">::</span><span class="n">reset</span><span class="p">(</span><span class="k">const</span> <span class="n">mc_control</span><span class="o">::</span><span class="n">ControllerResetData</span> <span class="o">&amp;</span> <span class="n">reset_data</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">mc_control</span><span class="o">::</span><span class="n">MCController</span><span class="o">::</span><span class="n">reset</span><span class="p">(</span><span class="n">reset_data</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="resetpythonpythonTabContent" role="tabpanel" arial-labelledby="resetpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">reset_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">pass</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p>Here we are simply delegating to the <code>MCController</code> class (implicitly in the Python case). <code>reset_data</code> contains the initial robot configuration provided by the interface. The default implementation makes sure that the robot is correctly initialized and that the posture task objective is set to the current robot's posture.</p>

<p>Then we have the <code>run</code> function. This function is going to be called for every iteration of the controller.</p>

<ul class="nav nav-tabs" id="runTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="runc-cppTab" data-toggle="tab" href="#runc-cppTabContent" role="tab" aria-controls="runc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="runpythonpythonTab" data-toggle="tab" href="#runpythonpythonTabContent" role="tab" aria-controls="runpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="runTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="runc-cppTabContent" role="tabpanel" arial-labelledby="runc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">bool</span> <span class="n">MyFirstController</span><span class="o">::</span><span class="n">run</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">return</span> <span class="n">mc_control</span><span class="o">::</span><span class="n">MCController</span><span class="o">::</span><span class="n">run</span><span class="p">();</span>
<span class="p">}</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="runpythonpythonTabContent" role="tabpanel" arial-labelledby="runpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">True</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p>Here we are also delegating the call to the <code>MCController</code> class (also implicitly in the Python case). The function should return true if everything goes well and false if the control should be interrupted. The default implementation runs the QP solver with the tasks and constraints provided by your program and use the resulting acceleration to update the desired robot's state.</p>

<p>Finally, the last piece of code allows mc_rtc to load your controller:</p>

<ul class="nav nav-tabs" id="createControllerTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="createcontrollerc-cppTab" data-toggle="tab" href="#createcontrollerc-cppTabContent" role="tab" aria-controls="createcontrollerc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="createcontrollerpythonpythonTab" data-toggle="tab" href="#createcontrollerpythonpythonTabContent" role="tab" aria-controls="createcontrollerpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="createControllerTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="createcontrollerc-cppTabContent" role="tabpanel" arial-labelledby="createcontrollerc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="c1">// Should not be in any namespace</span>
<span class="n">CONTROLLER_CONSTRUCTOR</span><span class="p">(</span><span class="s">"MyFirstController"</span><span class="p">,</span> <span class="n">MyFirstController</span><span class="p">)</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="createcontrollerpythonpythonTabContent" role="tabpanel" arial-labelledby="createcontrollerpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">@</span><span class="nb">staticmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">robot</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">mc_rbdyn</span><span class="p">.</span><span class="n">get_robot_module</span><span class="p">(</span><span class="s">"env"</span><span class="p">,</span> <span class="n">mc_rtc</span><span class="p">.</span><span class="n">MC_ENV_DESCRIPTION_PATH</span><span class="p">,</span> <span class="s">"ground"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MyFirstController</span><span class="p">([</span><span class="n">robot</span><span class="p">,</span><span class="n">env</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p>It's unlikely you would need to modify this but it's vital not to forget it so we are mentioning it here.</p>

<h3 id="shaking-the-head-left-and-right">Shaking the head left and right</h3>


<p>We will start by adding two properties to our controller, one will hold the joint index for the head joint we are going to move, the other will tell us in which direction we are going.</p>

<ul class="nav nav-tabs" id="propertiesTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="propertiesc-cppTab" data-toggle="tab" href="#propertiesc-cppTabContent" role="tab" aria-controls="propertiesc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="propertiespythonpythonTab" data-toggle="tab" href="#propertiespythonpythonTabContent" role="tab" aria-controls="propertiespythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="propertiesTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="propertiesc-cppTabContent" role="tabpanel" arial-labelledby="propertiesc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="c1">// Added to MyFirstController.h in the private members</span>
<span class="kt">int</span> <span class="n">jointIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">goingLeft</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="propertiespythonpythonTabContent" role="tabpanel" arial-labelledby="propertiespythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Added inside MyFirstController __init__ method
</span><span class="bp">self</span><span class="p">.</span><span class="n">jointIndex</span> <span class="o">=</span> <span class="mi">0</span>
<span class="bp">self</span><span class="p">.</span><span class="n">goingLeft</span> <span class="o">=</span> <span class="bp">True</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p>To initialize the joint index, we need to ask the robot class. In JVRC1, the head yaw joint is called <code>NECK_Y</code>, hence the following code in our controller constructors:</p>

<ul class="nav nav-tabs" id="init_jindexTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="init-jindexc-cppTab" data-toggle="tab" href="#init-jindexc-cppTabContent" role="tab" aria-controls="init-jindexc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="init-jindexpythonpythonTab" data-toggle="tab" href="#init-jindexpythonpythonTabContent" role="tab" aria-controls="init-jindexpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="init_jindexTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="init-jindexc-cppTabContent" role="tabpanel" arial-labelledby="init-jindexc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">jointIndex</span> <span class="o">=</span> <span class="n">robot</span><span class="p">().</span><span class="n">jointIndexByName</span><span class="p">(</span><span class="s">"NECK_Y"</span><span class="p">);</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="init-jindexpythonpythonTabContent" role="tabpanel" arial-labelledby="init-jindexpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="bp">self</span><span class="p">.</span><span class="n">jointIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">robot</span><span class="p">().</span><span class="n">jointIndexByName</span><span class="p">(</span><span class="s">"NECK_Y"</span><span class="p">)</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p>Next we will write a function to update the target accordingly if we want the robot to look left or right:</p>

<ul class="nav nav-tabs" id="switch_targetTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="switch-targetc-cppTab" data-toggle="tab" href="#switch-targetc-cppTabContent" role="tab" aria-controls="switch-targetc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="switch-targetpythonpythonTab" data-toggle="tab" href="#switch-targetpythonpythonTabContent" role="tab" aria-controls="switch-targetpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="switch_targetTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="switch-targetc-cppTabContent" role="tabpanel" arial-labelledby="switch-targetc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">void</span> <span class="n">MyFirstController</span><span class="o">::</span><span class="n">switch_target</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">goingLeft</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">postureTask</span><span class="o">-&gt;</span><span class="n">target</span><span class="p">({{</span><span class="s">"NECK_Y"</span><span class="p">,</span> <span class="n">robot</span><span class="p">().</span><span class="n">qu</span><span class="p">()[</span><span class="n">jointIndex</span><span class="p">]}});</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="n">postureTask</span><span class="o">-&gt;</span><span class="n">target</span><span class="p">({{</span><span class="s">"NECK_Y"</span><span class="p">,</span> <span class="n">robot</span><span class="p">().</span><span class="n">ql</span><span class="p">()[</span><span class="n">jointIndex</span><span class="p">]}});</span>
  <span class="p">}</span>
  <span class="n">goingLeft</span> <span class="o">=</span> <span class="o">!</span><span class="n">goingLeft</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="switch-targetpythonpythonTabContent" role="tabpanel" arial-labelledby="switch-targetpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">switch_target</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">goingLeft</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">postureTask</span><span class="p">.</span><span class="n">target</span><span class="p">({</span><span class="s">"NECK_Y"</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">robot</span><span class="p">().</span><span class="n">qu</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">jointIndex</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">postureTask</span><span class="p">.</span><span class="n">target</span><span class="p">({</span><span class="s">"NECK_Y"</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">robot</span><span class="p">().</span><span class="n">ql</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">jointIndex</span><span class="p">]})</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">goingLeft</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">goingLeft</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p><em>Note: it's also possible to update the full posture target by using <code>postureTask->posture()</code> to get the current target and <code>postureTask->posture(new_posture)</code> to change the target but we use a more readable version here.</em></p>

<p>Finally, we modify the <code>run</code> function to update the robot's behaviour according to the current task error:</p>

<ul class="nav nav-tabs" id="update_targetTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="update-targetc-cppTab" data-toggle="tab" href="#update-targetc-cppTabContent" role="tab" aria-controls="update-targetc-cppTabContent" aria-selected="true">C++</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="update-targetpythonpythonTab" data-toggle="tab" href="#update-targetpythonpythonTabContent" role="tab" aria-controls="update-targetpythonpythonTabContent" aria-selected="false">Python</a>
    </li>
  
</ul>
<div class="tab-content" id="update_targetTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="update-targetc-cppTabContent" role="tabpanel" arial-labelledby="update-targetc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="kt">bool</span> <span class="n">MyFirstController</span><span class="o">::</span><span class="n">run</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">abs</span><span class="p">(</span><span class="n">postureTask</span><span class="o">-&gt;</span><span class="n">posture</span><span class="p">()[</span><span class="n">jointIndex</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">robot</span><span class="p">().</span><span class="n">mbc</span><span class="p">().</span><span class="n">q</span><span class="p">[</span><span class="n">jointIndex</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">switch_target</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">mc_control</span><span class="o">::</span><span class="n">MCController</span><span class="o">::</span><span class="n">run</span><span class="p">();</span>
<span class="p">}</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="update-targetpythonpythonTabContent" role="tabpanel" arial-labelledby="update-targetpythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">postureTask</span><span class="p">.</span><span class="n">posture</span><span class="p">()[</span><span class="bp">self</span><span class="p">.</span><span class="n">jointIndex</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">robot</span><span class="p">().</span><span class="n">mbc</span><span class="p">.</span><span class="n">q</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">jointIndex</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">switch_target</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">True</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>


<p><em>Note: alternatively, we could monitor <code>postureTask->eval().norm()</code> which gives the total error of the task. However here we are only concerned with the head yaw joint.</em></p>

<p>Et voil&agrave;! You can run this controller and see that the robot is moving its head from left to right. For the next tutorial we will continue using this controller, however, the code samples will not reflect the existing head-moving code.</p>

<p>The full sources for this controller are available <a href="sources/first-controller.html">here</a>.</p>

<h4 id="find-out-available-joints-in-a-robot">Find out available joints in a robot</h4>


<p>You might be tempted to try this controller with different robots but not knowing which joints are available in your robot, the following snippet will print out a list of one dof joint that can be used in the sample code interchangeably with <code>NECK_Y</code>:</p>

<ul class="nav nav-tabs" id="show_jointsTab" role="tablist">
  
    <li class="nav-item">
      
      
      <a class="nav-link active" id="show-jointspythonpythonTab" data-toggle="tab" href="#show-jointspythonpythonTabContent" role="tab" aria-controls="show-jointspythonpythonTabContent" aria-selected="true">Python</a>
    </li>
  
    <li class="nav-item">
      
      
      <a class="nav-link" id="show-jointsc-cppTab" data-toggle="tab" href="#show-jointsc-cppTabContent" role="tab" aria-controls="show-jointsc-cppTabContent" aria-selected="false">C++</a>
    </li>
  
</ul>
<div class="tab-content" id="show_jointsTabContent">
  
    
    
    
    
    <div class="tab-pane show active" id="show-jointspythonpythonTabContent" role="tabpanel" arial-labelledby="show-jointspythonpythonTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">mc_rbdyn</span>
<span class="c1"># Here you can change the robot module name with your own robot
</span><span class="n">rm</span> <span class="o">=</span> <span class="n">mc_rbdyn</span><span class="p">.</span><span class="n">get_robot_module</span><span class="p">(</span><span class="s">"JVRC1"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="s">"- {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">name</span><span class="p">())</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">rm</span><span class="p">.</span><span class="n">mb</span><span class="p">.</span><span class="n">joints</span><span class="p">()</span> <span class="k">if</span> <span class="n">j</span><span class="p">.</span><span class="n">dof</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]))</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
    
    
    
    
    <div class="tab-pane" id="show-jointsc-cppTabContent" role="tabpanel" arial-labelledby="show-jointsc-cppTab">
      

<div class="card bg-light card-source">
  <div class="card-body">

  <figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;mc_rbdyn/RobotLoader.h&gt;
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// Here you can change the robot module name with your own robot</span>
  <span class="k">auto</span> <span class="n">rm</span> <span class="o">=</span> <span class="n">mc_rbdyn</span><span class="o">::</span><span class="n">RobotLoader</span><span class="o">::</span><span class="n">get_robot_module</span><span class="p">(</span><span class="s">"JVRC1"</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span> <span class="n">j</span> <span class="o">:</span> <span class="n">rm</span><span class="o">-&gt;</span><span class="n">mb</span><span class="p">.</span><span class="n">joints</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">dof</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="p">.</span><span class="n">isMimic</span><span class="p">())</span>
    <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"- "</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">.</span><span class="n">name</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

  
  </div>
</div>

    </div>
  
</div>




        <hr/>
        
        <div class="text-right">
          <a href="/mc_rtc/tutorials/introduction/com-controller.html">Next tutorial: Controlling the CoM</a>
        </div>
        
      </div>
      </div>
    </div>

    <div class="container-fluid">
  <footer>
    <hr>
    <div class="row">
      <div class="col-8 offset-lg-2 col-lg-6">
        Copyright &copy; CNRS-AIST JRL, CNRS LIRMM 2015-2020
      </div>
      <div class="col-4 col-lg-2 text-right">
        <a href="/mc_rtc/credits.html">Credits</a>
      </div>
    </div>
  </footer>
</div>

  </body>

  <script type="text/javascript">
$(document).ready(function()
{
  new ClipboardJS('.copy-button');
});
</script>


</html>
